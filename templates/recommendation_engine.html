<!DOCTYPE html>
<html>
<head>
    <title>Recommendation Engine</title>
    <script>
        async function fetchTopCombinations() {
            const response = await fetch('/recommendation_engine');
            const data = await response.json();
            const tableBody = document.getElementById('top-combinations-body');
            tableBody.innerHTML = '';
            data.top_combinations.forEach(item => {
                const row = `<tr><td>${item.items}</td><td>${item.percentage}%</td></tr>`;
                tableBody.innerHTML += row;
            });
        }

        async function fetchItemList() {
            const response = await fetch('/recommendation_engine/items');
            const data = await response.json();
            const dropdown = document.getElementById('item-dropdown');
            dropdown.innerHTML = '';
            data.forEach(item => {
                dropdown.innerHTML += `<option value="${item}">${item}</option>`;
            });
        }

        async function fetchItemCombinations() {
            const selectedItem = document.getElementById('item-dropdown').value;
            const response = await fetch(`/recommendation_engine/${selectedItem}`);
            const data = await response.json();
            const list = document.getElementById('item-combinations');
            list.innerHTML = '';
            data.forEach(item => {
                const listItem = `<li>${item.combination} (${item.percentage}%)</li>`;
                list.innerHTML += listItem;
            });
        }

        window.onload = async function() {
            await fetchTopCombinations();
            await fetchItemList();
        };
    </script>
</head>
<body>
    <h1>Recommendation Engine</h1>

    <h2>Most Common Item Combinations</h2>
    <table border="1">
        <thead>
            <tr>
                <th>Items</th>
                <th>Percentage of Orders</th>
            </tr>
        </thead>
        <tbody id="top-combinations-body"></tbody>
    </table>

    <h2>Find Common Combinations for an Item</h2>
    <select id="item-dropdown" onchange="fetchItemCombinations()">
        <!-- Options will be filled dynamically -->
    </select>
    <ul id="item-combinations"></ul>

</body>
</html>
